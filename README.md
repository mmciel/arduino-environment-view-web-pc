![](https://i.loli.net/2019/04/04/5ca56084f2b3d.jpg)

-------------

 

 

郑州轻工业大学

**课程设计说明书**

 

 

 

**题目：办公室环境监测与可视化系统**

 

 

 

**学院：计算机与通信工程学院**

**专业班级：物联网工程****17-01**

**组别：第****04****小组**

**指导教师：邹东尧、席广永**

 

 

 

 

 

 

 

**时间：****2018-2019****（****1****）**

 


 

**课程设计成绩评定表**































































































| **评定项目**                                                 | **内容**                                                     | **满分**     | **评分** | **总分** |
| ------------------------------------------------------------ | ------------------------------------------------------------ | ------------ | -------- | -------- |
| 学习态度                                                     | 学习认真，态度端正，遵守纪律。                               | 10           |          |          |
| 答疑和   设计情况                                            | 认真查阅资料，勤学好问，提出的问题有一定的深度，分析解决问题的能力较强。 | 40           |          |          |
| 说明书   质量                                                | 设计方案正确、表达清楚；设计思路、实验（论证）方法科学合理；达到课程设计任务书规定的要求；图、表、文字表达准确规范，上交及时。 | 40           |          |          |
| 回答问题情况                                                 | 回答问题准确，基本概念清楚，有理有据，有一定深度。           | 10           |          |          |
| 组别                                                         | 姓名                                                         | 学号         | 成绩     |          |
| 第四组                                                       | 方铄                                                         | 541707090106 |          |          |
| 曹梦颖                                                       | 541707090101                                                 |              |          |          |
| 刘小妮                                                       | 541707090126                                                 |              |          |          |
| 李文豪                                                       | 541707090123                                                 |              |          |          |
| 冯子尧                                                       | 541707090108                                                 |              |          |          |
| **指导教师评语：**           **签名：**   **年**     **月**     **日** |                                                              |              |          |          |



















 

郑州轻工业学院

**课 程 设 计 任 务 书**

 

**题目：****办公室环境监测与可视化系统**

**组别、学号及姓名：**

| 组别   | 姓名         | 学号         |
| ------ | ------------ | ------------ |
| 第四组 | 方铄         | 541707090106 |
| 曹梦颖 | 541707090101 |              |
| 刘小妮 | 541707090126 |              |
| 李文豪 | 541707090123 |              |
| 冯子尧 | 541707090108 |              |

 

**主要内容：**

在办公环境下，人们需要控制并了解办公环境的数据。因此基于arduino的办公室环境监测与可视化系统需要完成对基本环境数据的采集与显示、对部分数据的可视化、对功能的控制、常用功能的集成等工作。所以，本系统采用arduino UNO作为下位机实现数据的采集、功能的控制、数据的发送等功能。上位机方面，利用java实现定制的串口通讯与数据转发工具、利用python实现本地数据可视化、利用mysql与javaweb实现云端数据存储与云端数据可视化。

**基本要求：**

\1.     下位机需要利用arduino UNO3实现基本的控制功能、数据采集功能、数据发送功能、基本环境控制功能。

\2.     上位机：

(1)    利用java编写串口通讯与数据转发到云端工具。

(2)    利用python编写本地数据可视化脚本。

(3)    利用云端的mysql数据库以及web服务器分别实现数据的存储和web端数据可视化。

**主要参考资料：**

[1]罗尹奇,刘力银.基于JNI的Java串口通信系统的设计与实现——以Windows平台为例[J].电脑知识与技术,2017,13(34):51-56.

[2]刘雨珂,王平.基于Python+Pandas+Matplotlib的学生成绩数据统计与图形输出实现[J].福建电脑,2017,33(11):104-106+142.

[3]王诚.研究JDBC连接MySQL数据库技术[J].网络安全和信息化,2018(12):68-69.

[4]黄雅莉,钟琪.基于Ajax与Echarts的网页动态数据加载[J].科技资讯,2018,16(23):34-35+37.

[5]冉从敬,徐晓飞.基于NodeJS+ECharts的专利权人引证关系可视化方法研究[J].情报科学,2018,36(08):77-83.

[6]黄宇栋.百度Echarts在数据可视化分析中的应用[J].金融科技时代,2018(06):43-45.

[7]赵红. 基于JavaScript的微信车辆服务系统的设计与实现[D].吉林大学,2016.

 

 

 

 

 

 

**完  成  期  限：2018年01月04日**

**指导教师签名：**

**课程负责人签名：**

**年     月      日**

目  录

 

[1     需求说明... 1](#_Toc534365964)

[1.1      需求说明... 1](#_Toc534365965)

[2     功能描述... 1](#_Toc534365966)

[2.1      系统功能描述... 1](#_Toc534365967)

[2.1.1       下位机功能描述... 1](#_Toc534365968)

[2.1.2       上位机功能描述... 1](#_Toc534365969)

[3     系统设计及实现... 1](#_Toc534365970)

[3.1      系统总体设计... 1](#_Toc534365971)

[3.2      系统设计原理图... 2](#_Toc534365972)

[3.3      系统设计准备... 3](#_Toc534365973)

[3.3.1      器材... 3](#_Toc534365974)

[3.3.2      环境... 3](#_Toc534365975)

[3.3.3      实物连接... 4](#_Toc534365976)

[3.4      系统下位机设计... 4](#_Toc534365977)

[3.4.1      控制台模块实现... 4](#_Toc534365978)

[3.4.2      数据上传模块实现... 6](#_Toc534365979)

[3.4.3      功能模块实现... 6](#_Toc534365980)

[3.5      系统上位机设计... 7](#_Toc534365981)

[3.5.1      串口通讯与数据转发模块实现... 7](#_Toc534365982)

[3.5.2      本地数据可视化脚本实现... 8](#_Toc534365983)

[3.5.3      云端数据库及web服务器实现实现... 9](#_Toc534365984)

[实训总结和心得... 12](#_Toc534365985)

[4     参考文献... 15](#_Toc534365986)

[5     附录（代码）... 16](#_Toc534365987)

 

 


 

# 1    需求说明



# 2       功能描述

## 2.1   系统功能描述

### 2.1.1    下位机功能描述

\1.     Arduino系统总控制模块：实现对数据发送、光控、风控的关闭与打开；实现了万年历、温湿度数据显示；实现了红外信号的控制。

\2.     Arduino数据发送模块：实现了温湿度数据的串口发送。

\3.     Arduino功能模块：实现风控与光控功能。

### 2.1.2    上位机功能描述

\1.     串口通讯模块与数据转发模块：通过java Swing实现的串口通讯与数据转发到云端数据库。

\2.     数据可视化脚本：通过python matplotlib库实现对云端数据的加载和数据的可视化绘图

\3.     Web服务器：通过java web相关技术搭建可访问的数据可视化网站。

# 3    系统设计及实现

## 3.1  系统总体设计

 

\1.     下位机：

利用三个arduino UNO3 实现三大模块：控制模块、数据发送模块、功能模块。

\2.     上位机：

利用java实现串口通讯与数据转发；

利用python实现本地数据可视化。

利用mysql实现数据的存储

利用web实现云服务器



 

 

 

## 3.3    系统设计准备

### 3.3.1 器材

Arduino UNO3：3个

DTH11:1个

光敏传感器：2个

红外传感器：1个

LCD1602：1个

电机：1个

电位器：1个

LED：若干

电阻：若干

杜邦线：若干

面包板：若干

### 3.3.2 环境

\1.     下位机：

(1)    VS 2015

(2)    Arduino IDE 1.8

(3)    Fritzing

(4)    串口通讯助手

\2.     上位机：

(1)    JDK1.8+Eclipse+windowbulider

(2)    Python3.5+pycharm+pip matplotlib

(3)    Mysql 5.5+Navicat12

(4)    Eclipse EE+Tomcat8+JDK1.8+jQuery+JavaScript+echarts-all

### 3.3.3 实物连接



## 3.4    系统下位机设计

### 3.4.1 控制台模块实现

\1.     完成功能：

控制数据是否可以上传到云端

控制风扇工作

控制光控灯工作

万年历显示

温湿度显示

\2.     实现方案：

采用红外控制lcd1602显示指定菜单，提示指定键可以操作开关。开关使用引脚电平高低控制其他的arduino。温湿度通过接入指定的引脚的数据进行读入。



### 3.4.2 数据上传模块实现

1. 完成功能：完成数据发送到串口
2. 实现方案：采用Arduino Serial
3. 效果展示：数据库中的数据如图所示：

 ![](https://i.loli.net/2019/04/04/5ca5612f65487.jpg)





## 3.5    系统上位机设计

左侧的panel是关于串口数据的发送与接收，窗口可显示串口数据的接受，包含开启关闭串口等功能，还有清空串口刷新新添加串口等功能。右侧的panel是转发数据到数据库，通过设置指定的mysql url、username、password、table等可开启服务发送数据到云服务器，此过程必须在联网状态下进行。

 

 

![](https://i.loli.net/2019/04/04/5ca5617000e57.jpg)

图3- 7串口通讯与数据转发模块展示

 

 

### 3.5.2 本地数据可视化脚本实现

1. 完成功能：本地数据的可视化
2. 实现方案：python3+matplotlib

利用python脚本实现从云服务器提取数据字典，利用matplotlib库绘制图像。

1. 效果展示：

![](https://i.loli.net/2019/04/04/5ca5618d3f09d.jpg)

图3- 8本地可视化模块

 

### 3.5.3 云端数据库及web服务器实现实现

1. 完成功能：任意联网设备访问指定地址即可查看环境数据
2. 实现方案：javawe（servlet+jQueryjson+JavaScript+echarts+tomcat8+mysql）

利用java Servlet搭建服务器，mysql实现数据库存储，jquery json数据实现前端后台数据传递，echart JavaScript库实现前端图像绘制。下面是项目结构和数据表单。

![](https://i.loli.net/2019/04/04/5ca561a4e2c59.jpg)



图3- 9 数据库



